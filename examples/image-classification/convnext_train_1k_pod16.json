{
  "embedding_serialization_factor": 1,
  "recompute_checkpoint_every_layer": true,
  "optimizer_state_offchip": false,
  "replicated_tensor_sharding": true,
  "enable_half_first_order_momentum": false,
  "enable_half_partials": false,
  "fp32": false,

  "per_device_train_batch_size": 2,
  "per_device_eval_batch_size": 2,

  "pod_type": "pod16",
  "replication_factor": {"pod4": 2, "pod8": 4, "pod16": 8, "pod32": 8, "pod64": 16, "default": 1},
  "device_iterations": 1,
  "inference_device_iterations": 2,
  "inference_replication_factor": 8,
  "gradient_accumulation_steps": 256,
  "executable_cache_dir": "./exe_cache",


  "learning_rate": 4.0e-3,
  "weight_decay": 0.05,
  "num_train_epochs": 300,
  "warmup_epochs": 20,
  "do_train": true,
  "do_eval": true,
  "train_val_split": 0.1,
  "train_dir": "/localdata/datasets/imagenet-raw-data/train/",
  "validation_dir": "/localdata/datasets/imagenet-raw-data/validation",
  "output_dir": "./training-outputs-truc-init",
  "model_name_or_path": "facebook/convnext-tiny-224",
  "feature_extractor_name": "facebook/convnext-tiny-224",

  "ipus_per_replica": 2,
  "layers_per_ipu": [8,10],


  "dataloader_drop_last": true,
  "dataloader_mode": "async",
  "dataloader_num_workers": 32,

  "seed": 1337,
  "overwrite_output_dir": true,
  "ipu_config_name": "./convnext_train_1k_pod16.json",
  "disable_feature_extractor" : true,

  "layer_scale_init_value" : 1e-6,
  "drop_path_rate": 0.1,
  "smoothing": 0.1,
  "mixup": 0.8,
  "cutmix": 1.0,
  "lr_scheduler_type": "cosine",
  "logging_strategy": "steps",
  "logging_steps": 50,
  "logging_dir": "logs",
  "wandb_project" : "convnext_training_pod16",
  "wandb_entity" : "pse",
  "report_to" : "wandb",
  "reset_weights": true
  }